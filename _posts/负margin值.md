---
title: 负margin值
date: 2016-08-02 20:37:20
tags:
	- 布局
categories:
	- CSS
---
最近在看bootstrap源码的时候发现栅格系统.row类的默认设置了左右各自-15px的外边距，十分好奇，虽然之前就知道在标准中外边距是可以设置为负值，但是一直都没有深入思考负margin值的作用，然后在搜索这个字段的时候发现网上已经有不少出色的文章来介绍负margin的用途。在经过简单的demo测试后整理了这篇文章。

<!--more-->

这是参考的两篇文章：[负margin在页面布局中的应用](http://www.cnblogs.com/jscode/archive/2012/08/28/2660078.html)和 [CSS布局奇淫巧计之-强大的负边距](http://www.cnblogs.com/2050/archive/2012/08/13/2636467.html)。

## 外边距
首先需要简单的回顾一下外边距：
外边距是盒子模型中的组成部分之一，即围绕在元素边框之外的那段空白区域。margin是支撑div布局的基础属性值，我们平常看见文档流中的两个元素之间的距离，就是由这两个元素在对应方向上的外边距之和。也就是说，在文档流中，元素的最终边界是由margin决定的。
那么当margin为负数时会怎么样呢？margin为负的时候就相当于元素的边界向里收，文档流认的只是这个边界，不会管你实际的尺寸是多少。
思考一下，负的外边距的意义是什么呢？

## 负的外边距
前面提到，我们看见的两个元素之间的距离（这里就不考虑定位的问题了），是由这两个元素在对应方向上的外边距代数和决定了，如果该代数和为负值，即代表他们之间的距离为负值，在这种情况下两个元素部分覆盖的现象。
但是使用负margin值形成的元素覆盖与使用浮动或者定位形成的元素覆盖是不一样的：
* 浮动的元素，会脱离文档流并按照指定方向漂移，并覆盖停止浮动时原本位置上的元素；
* 使用定位的元素，是通过制定z-index设定层级并进行元素覆盖的；
* 而使用负magin值，会影响文档流，却并不是像浮动和绝对定位那样完全脱离文档流，也不是像相对定位那样完全占据原本的文档流位置。margin只是一个基本属性，负margin值也只是一个完全符合标准的属性值：
	* 元素的margin-top/margin-left被赋予负值时，元素将被拉进指定的方向，覆盖之前的元素；
	* 设置margin-bottom/right为负数，元素并不会向下/右移动，而是将后续的元素拖拉进来，覆盖本来的元素。

## 作用
由于margin也是盒子模型的一部分，因此利用负margin值，可以减小盒子在文档流所占据的空间，从而达到理想的布局效果。正是这个原因，利用负margin值可以很简单的生成一些经典的布局。
### 清除子元素右边距
最近某个项目里面的商品展示，每行三张图片，每两张图片中间有固定间距。这种布局在移动端还是十分常见的，大致思路就是使用浮动来实现，但是由于浮动需要为元素预留足够的宽度，否则元素会换行。之前的做法是使用:nth-of-type(3n){margin-right:0;}来实现，但是需要考虑nth-of-type选择器的兼容问题，因此这里使用负margin也不失为一种办法：
```
	//css
    ul,li { list-style:none; margin: 0; padding: 0}
    .wrap { width: 320px; height: 300px ;background: #ccc; }
    .wrap  ul { margin-right: -10px ;}
    .wrap  li { 
        width: 100px; height: 100px; float: left; margin-right: 10px;
        background: red; 
    }
    //html
    <div class="wrap">
        <ul>
            <li></li>
            <li></li>
            <li></li>
        </ul>
    </div>
```
只需要为ul设置一个负margin值就可以完美解决这个问题，上面提到过，将magrin-right设置为负，并不是让元素向右偏移，而是将更右边的元素向左拉进并覆盖现有元素（即使实际上更右边并没有这个元素）。
### 竖直居中
众所周知，水平居中是很容易就可以实现的，比如text-align:center;和margin:0 auto;这两个样式就够用了，但是竖直居中就比较麻烦了，在不知道父容器高度的情况下，实现竖直居中曾经是一件非常困难的事，但是使用负margin值可以轻松实现。
```
    .wrap { 
        width: 320px; height: 300px ; 
        position: absolute; top: 50% ;left: 50%;
        margin-left: -160px; margin-top: -150px;
        background: #ccc;
    }
```
在某些不知道具体高度的情况下，可以使用transform:translateY(-50%)来达到竖直居中的效果。

## 最后
当然负的margin还能在其他的一些布局样式中大展身手，但是，鉴于负margin值对于文档流的这种不确定性影响（根据其数值大小），我觉得使用的时候还是应当慎重一点，此外，负的magin值也是存在一定的兼容性问题，这样的话更应该小心一些。
最后，关于负的margin值，还有两个小细节：
* margin值如果设置为百分数，具体计算数值是相对于父元素的width计算的;
* 如果没有设定width属性，设定负margin-left/right会将元素拖向对应的方向，并增加宽度，此时的margin的作用就像padding一样，具体原因目前并没有找到。